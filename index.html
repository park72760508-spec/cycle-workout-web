<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>ì‚¬ì´í´ ì•„ì¹´ë°ë¯¸ - iOS ë²„ì „</title>
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <style>
        :root {
            --primary-color: #007AFF;
            --secondary-color: #5856D6;
            --success-color: #34C759;
            --warning-color: #FF9500;
            --danger-color: #FF3B30;
            --background: #F2F2F7;
            --card-background: #FFFFFF;
            --text-primary: #000000;
            --text-secondary: #8E8E93;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Display', sans-serif;
            background: var(--background);
            color: var(--text-primary);
            line-height: 1.6;
            padding: env(safe-area-inset-top) env(safe-area-inset-right) env(safe-area-inset-bottom) env(safe-area-inset-left);
        }

        .container {
            max-width: 100%;
            margin: 0 auto;
            padding: 20px;
        }

        .card {
            background: var(--card-background);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 16px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
        }

        .header h1 {
            font-size: 28px;
            font-weight: 700;
            color: var(--primary-color);
            margin-bottom: 8px;
        }

        .header .subtitle {
            color: var(--text-secondary);
            font-size: 16px;
        }

        .ios-notice {
            background: linear-gradient(135deg, #FF9500, #FF6B35);
            color: white;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
            text-align: center;
        }

        .ios-notice h3 {
            margin-bottom: 10px;
            font-size: 18px;
        }

        .btn {
            background: var(--primary-color);
            color: white;
            border: none;
            padding: 16px 24px;
            border-radius: 10px;
            font-size: 17px;
            font-weight: 600;
            cursor: pointer;
            width: 100%;
            margin-bottom: 12px;
            transition: all 0.2s ease;
        }

        .btn:active {
            transform: scale(0.98);
            opacity: 0.8;
        }

        .btn-secondary {
            background: var(--text-secondary);
        }

        .btn-success {
            background: var(--success-color);
        }

        .btn-warning {
            background: var(--warning-color);
        }

        .training-mode {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 16px;
            margin-bottom: 20px;
        }

        .mode-card {
            background: var(--card-background);
            border-radius: 12px;
            padding: 20px;
            text-align: center;
            cursor: pointer;
            border: 2px solid transparent;
            transition: all 0.2s ease;
        }

        .mode-card.active {
            border-color: var(--primary-color);
            background: rgba(0, 122, 255, 0.1);
        }

        .mode-card h4 {
            margin-bottom: 8px;
            font-size: 16px;
        }

        .mode-card p {
            font-size: 14px;
            color: var(--text-secondary);
        }

        .manual-input {
            display: none;
        }

        .manual-input.active {
            display: block;
        }

        .input-group {
            margin-bottom: 16px;
        }

        .input-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--text-primary);
        }

        .input-group input {
            width: 100%;
            padding: 12px 16px;
            border: 1px solid #D1D1D6;
            border-radius: 10px;
            font-size: 17px;
            background: var(--card-background);
        }

        .input-group input:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(0, 122, 255, 0.1);
        }

        .metrics-display {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 16px;
            margin-bottom: 20px;
        }

        .metric {
            background: var(--card-background);
            border-radius: 12px;
            padding: 20px;
            text-align: center;
        }

        .metric-value {
            font-size: 32px;
            font-weight: 700;
            color: var(--primary-color);
            margin-bottom: 4px;
        }

        .metric-label {
            font-size: 14px;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .timer-display {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            border-radius: 16px;
            padding: 30px;
            text-align: center;
            margin-bottom: 20px;
        }

        .timer-value {
            font-size: 48px;
            font-weight: 300;
            margin-bottom: 8px;
            font-variant-numeric: tabular-nums;
        }

        .timer-label {
            font-size: 16px;
            opacity: 0.8;
        }

        .controls {
            display: flex;
            gap: 12px;
            margin-top: 20px;
        }

        .control-btn {
            flex: 1;
            padding: 16px;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .control-btn:active {
            transform: scale(0.95);
        }

        .start-btn {
            background: var(--success-color);
            color: white;
        }

        .pause-btn {
            background: var(--warning-color);
            color: white;
        }

        .stop-btn {
            background: var(--danger-color);
            color: white;
        }

        .workout-selector {
            margin-bottom: 20px;
        }

        .workout-selector select {
            width: 100%;
            padding: 12px 16px;
            border: 1px solid #D1D1D6;
            border-radius: 10px;
            font-size: 17px;
            background: var(--card-background);
        }

        .pwa-install {
            background: linear-gradient(135deg, #34C759, #30D158);
            color: white;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
            text-align: center;
        }

        .pwa-install h3 {
            margin-bottom: 10px;
        }

        .pwa-install p {
            margin-bottom: 15px;
            opacity: 0.9;
        }

        .install-steps {
            text-align: left;
            margin-top: 15px;
        }

        .install-steps ol {
            margin-left: 20px;
        }

        .install-steps li {
            margin-bottom: 8px;
        }

        @media (max-width: 390px) {
            .training-mode {
                grid-template-columns: 1fr;
            }
            
            .metrics-display {
                grid-template-columns: 1fr;
            }
            
            .timer-value {
                font-size: 36px;
            }
        }

        .hidden {
            display: none !important;
        }

        /* iOS Safari íŠ¹í™” ìŠ¤íƒ€ì¼ */
        @supports (-webkit-touch-callout: none) {
            body {
                -webkit-user-select: none;
                -webkit-touch-callout: none;
                -webkit-tap-highlight-color: transparent;
            }
            
            input {
                -webkit-appearance: none;
            }
            
            .btn {
                -webkit-tap-highlight-color: transparent;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- í—¤ë” -->
        <div class="header">
            <h1>ğŸš´â€â™‚ï¸ ì‚¬ì´í´ ì•„ì¹´ë°ë¯¸</h1>
            <p class="subtitle">iOS íŠ¹í™” ë²„ì „</p>
        </div>

        <!-- iOS ì•ˆë‚´ -->
        <div class="ios-notice">
            <h3>ğŸ“± iOS ì‚¬ìš©ìë¥¼ ìœ„í•œ íŠ¹ë³„ ë²„ì „</h3>
            <p>ë¸”ë£¨íˆ¬ìŠ¤ ì—°ê²° ëŒ€ì‹  ìˆ˜ë™ ì…ë ¥ìœ¼ë¡œ ì™„ì „í•œ í›ˆë ¨ ê²½í—˜ì„ ì œê³µí•©ë‹ˆë‹¤</p>
        </div>

        <!-- PWA ì„¤ì¹˜ ì•ˆë‚´ -->
        <div class="pwa-install">
            <h3>ğŸ“² í™ˆ í™”ë©´ì— ì•±ìœ¼ë¡œ ì¶”ê°€í•˜ê¸°</h3>
            <p>ë” ë‚˜ì€ ê²½í—˜ì„ ìœ„í•´ í™ˆ í™”ë©´ì— ì¶”ê°€í•˜ì„¸ìš”</p>
            <div class="install-steps">
                <ol>
                    <li>Safari í•˜ë‹¨ì˜ ê³µìœ  ë²„íŠ¼ (ğŸ“¤) íƒ­</li>
                    <li>"í™ˆ í™”ë©´ì— ì¶”ê°€" ì„ íƒ</li>
                    <li>ì•± ì´ë¦„ í™•ì¸ í›„ "ì¶”ê°€" íƒ­</li>
                    <li>í™ˆ í™”ë©´ì—ì„œ ì•±ì²˜ëŸ¼ ì‚¬ìš©!</li>
                </ol>
            </div>
        </div>

        <!-- ì‚¬ìš©ì ì •ë³´ ì…ë ¥ -->
        <div class="card" id="userSetup">
            <h3 style="margin-bottom: 16px;">ğŸ‘¤ ì‚¬ìš©ì ì •ë³´</h3>
            <div class="input-group">
                <label>ì´ë¦„</label>
                <input type="text" id="userName" placeholder="ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”">
            </div>
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px;">
                <div class="input-group">
                    <label>FTP (W)</label>
                    <input type="number" id="userFTP" placeholder="250" min="100" max="500">
                </div>
                <div class="input-group">
                    <label>ëª¸ë¬´ê²Œ (kg)</label>
                    <input type="number" id="userWeight" placeholder="70" min="40" max="150">
                </div>
            </div>
            <button class="btn btn-success" onclick="saveUserInfo()">ì €ì¥í•˜ê³  ì‹œì‘</button>
        </div>

        <!-- í›ˆë ¨ ëª¨ë“œ ì„ íƒ -->
        <div class="card hidden" id="modeSelector">
            <h3 style="margin-bottom: 16px;">ğŸ¯ í›ˆë ¨ ëª¨ë“œ ì„ íƒ</h3>
            <div class="training-mode">
                <div class="mode-card" onclick="selectMode('manual')">
                    <h4>âœ‹ ìˆ˜ë™ ì…ë ¥</h4>
                    <p>ì§ì ‘ ë°ì´í„° ì…ë ¥</p>
                </div>
                <div class="mode-card" onclick="selectMode('simulator')">
                    <h4>ğŸ® ì‹œë®¬ë ˆì´í„°</h4>
                    <p>ìë™ ë°ì´í„° ìƒì„±</p>
                </div>
            </div>
        </div>

        <!-- ì›Œí¬ì•„ì›ƒ ì„ íƒ -->
        <div class="card hidden" id="workoutSelector">
            <h3 style="margin-bottom: 16px;">ğŸ“‹ ì›Œí¬ì•„ì›ƒ ì„ íƒ</h3>
            <div class="workout-selector">
                <select id="workoutSelect">
                    <option value="sst">SST (Sweet Spot Training) - 60ë¶„</option>
                    <option value="vo2max">VO2Max ì¸í„°ë²Œ - 45ë¶„</option>
                    <option value="recovery">íšŒë³µ ë¼ì´ë”© - 30ë¶„</option>
                    <option value="ftp_test">FTP í…ŒìŠ¤íŠ¸ - 75ë¶„</option>
                </select>
            </div>
            <button class="btn" onclick="startWorkout()">í›ˆë ¨ ì‹œì‘</button>
        </div>

        <!-- í›ˆë ¨ í™”ë©´ -->
        <div class="hidden" id="trainingScreen">
            <!-- íƒ€ì´ë¨¸ -->
            <div class="timer-display">
                <div class="timer-value" id="timerDisplay">00:00</div>
                <div class="timer-label">ê²½ê³¼ ì‹œê°„</div>
            </div>

            <!-- ë©”íŠ¸ë¦­ìŠ¤ í‘œì‹œ -->
            <div class="metrics-display">
                <div class="metric">
                    <div class="metric-value" id="powerDisplay">0</div>
                    <div class="metric-label">íŒŒì›Œ (W)</div>
                </div>
                <div class="metric">
                    <div class="metric-value" id="cadenceDisplay">0</div>
                    <div class="metric-label">ì¼€ì´ë˜ìŠ¤</div>
                </div>
                <div class="metric">
                    <div class="metric-value" id="heartRateDisplay">0</div>
                    <div class="metric-label">ì‹¬ë°•ìˆ˜</div>
                </div>
                <div class="metric">
                    <div class="metric-value" id="targetPowerDisplay">0</div>
                    <div class="metric-label">ëª©í‘œ íŒŒì›Œ</div>
                </div>
            </div>

            <!-- ìˆ˜ë™ ì…ë ¥ ëª¨ë“œ -->
            <div class="card manual-input" id="manualInputs">
                <h4 style="margin-bottom: 16px;">ğŸ“Š ì‹¤ì‹œê°„ ë°ì´í„° ì…ë ¥</h4>
                <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 12px;">
                    <div class="input-group">
                        <label>íŒŒì›Œ</label>
                        <input type="number" id="manualPower" placeholder="0" onchange="updateManualData()">
                    </div>
                    <div class="input-group">
                        <label>ì¼€ì´ë˜ìŠ¤</label>
                        <input type="number" id="manualCadence" placeholder="0" onchange="updateManualData()">
                    </div>
                    <div class="input-group">
                        <label>ì‹¬ë°•ìˆ˜</label>
                        <input type="number" id="manualHeartRate" placeholder="0" onchange="updateManualData()">
                    </div>
                </div>
            </div>

            <!-- í˜„ì¬ êµ¬ê°„ ì •ë³´ -->
            <div class="card">
                <h4 style="margin-bottom: 8px;" id="currentSegment">ì›œì—… êµ¬ê°„</h4>
                <p style="color: var(--text-secondary);" id="segmentDescription">FTP 60% - 5ë¶„ê°„ ëª¸í’€ê¸°</p>
                <div style="margin-top: 12px;">
                    <div style="background: #E5E5EA; height: 8px; border-radius: 4px; overflow: hidden;">
                        <div style="background: var(--primary-color); height: 100%; width: 0%; transition: width 0.3s ease;" id="segmentProgress"></div>
                    </div>
                </div>
            </div>

            <!-- ì»¨íŠ¸ë¡¤ -->
            <div class="controls">
                <button class="control-btn start-btn" id="startBtn" onclick="toggleTraining()">ì‹œì‘</button>
                <button class="control-btn pause-btn hidden" id="pauseBtn" onclick="toggleTraining()">ì¼ì‹œì •ì§€</button>
                <button class="control-btn stop-btn" onclick="stopTraining()">ì¢…ë£Œ</button>
            </div>
        </div>

        <!-- ê²°ê³¼ í™”ë©´ -->
        <div class="hidden" id="resultScreen">
            <div class="card">
                <h2 style="text-align: center; margin-bottom: 20px;">ğŸ‰ í›ˆë ¨ ì™„ë£Œ!</h2>
                <div class="metrics-display">
                    <div class="metric">
                        <div class="metric-value" id="avgPowerResult">0</div>
                        <div class="metric-label">í‰ê·  íŒŒì›Œ</div>
                    </div>
                    <div class="metric">
                        <div class="metric-value" id="maxPowerResult">0</div>
                        <div class="metric-label">ìµœëŒ€ íŒŒì›Œ</div>
                    </div>
                    <div class="metric">
                        <div class="metric-value" id="avgHRResult">0</div>
                        <div class="metric-label">í‰ê·  ì‹¬ë°•</div>
                    </div>
                    <div class="metric">
                        <div class="metric-value" id="caloriesResult">0</div>
                        <div class="metric-label">ì¹¼ë¡œë¦¬</div>
                    </div>
                </div>
                <button class="btn btn-success" onclick="saveWorkout()">ê²°ê³¼ ì €ì¥</button>
                <button class="btn btn-secondary" onclick="shareWorkout()">ê³µìœ í•˜ê¸°</button>
                <button class="btn" onclick="restartApp()">ìƒˆ í›ˆë ¨</button>
            </div>
        </div>
    </div>

    <script>
        let currentUser = null;
        let currentMode = null;
        let isTraining = false;
        let isPaused = false;
        let startTime = null;
        let timerInterval = null;
        let currentSegmentIndex = 0;
        let workoutData = [];

        const workouts = {
            sst: {
                name: "SST (Sweet Spot Training)",
                duration: 3600, // 60ë¶„
                segments: [
                    { name: "ì›œì—…", description: "FTP 60% - ê°€ë³ê²Œ ëª¸í’€ê¸°", targetPercent: 60, duration: 600 },
                    { name: "ë©”ì¸ ì„¸íŠ¸", description: "FTP 88% - ìŠ¤ìœ„íŠ¸ìŠ¤íŒŸ", targetPercent: 88, duration: 2400 },
                    { name: "ì¿¨ë‹¤ìš´", description: "FTP 50% - ë§ˆë¬´ë¦¬", targetPercent: 50, duration: 600 }
                ]
            },
            vo2max: {
                name: "VO2Max ì¸í„°ë²Œ",
                duration: 2700, // 45ë¶„
                segments: [
                    { name: "ì›œì—…", description: "FTP 65% - ì¤€ë¹„ìš´ë™", targetPercent: 65, duration: 900 },
                    { name: "ì¸í„°ë²Œ", description: "FTP 120% - ê³ ê°•ë„", targetPercent: 120, duration: 900 },
                    { name: "ì¿¨ë‹¤ìš´", description: "FTP 55% - ë§ˆë¬´ë¦¬", targetPercent: 55, duration: 900 }
                ]
            },
            recovery: {
                name: "íšŒë³µ ë¼ì´ë”©",
                duration: 1800, // 30ë¶„
                segments: [
                    { name: "ì „ì²´", description: "FTP 50% - ê°€ë²¼ìš´ í˜ë‹¬ë§", targetPercent: 50, duration: 1800 }
                ]
            }
        };

        function saveUserInfo() {
            const name = document.getElementById('userName').value.trim();
            const ftp = parseInt(document.getElementById('userFTP').value);
            const weight = parseInt(document.getElementById('userWeight').value);

            if (!name || !ftp || !weight) {
                alert('ëª¨ë“  ì •ë³´ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }

            if (ftp < 100 || ftp > 500) {
                alert('FTPëŠ” 100-500W ì‚¬ì´ë¡œ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }

            currentUser = { name, ftp, weight };
            
            document.getElementById('userSetup').classList.add('hidden');
            document.getElementById('modeSelector').classList.remove('hidden');
        }

        function selectMode(mode) {
            currentMode = mode;
            
            // ëª¨ë“  ëª¨ë“œ ì¹´ë“œì—ì„œ active í´ë˜ìŠ¤ ì œê±°
            document.querySelectorAll('.mode-card').forEach(card => {
                card.classList.remove('active');
            });
            
            // ì„ íƒëœ ëª¨ë“œ ì¹´ë“œì— active í´ë˜ìŠ¤ ì¶”ê°€
            event.target.classList.add('active');
            
            setTimeout(() => {
                document.getElementById('modeSelector').classList.add('hidden');
                document.getElementById('workoutSelector').classList.remove('hidden');
            }, 500);
        }

        function startWorkout() {
            const selectedWorkout = document.getElementById('workoutSelect').value;
            currentWorkout = workouts[selectedWorkout];
            
            document.getElementById('workoutSelector').classList.add('hidden');
            document.getElementById('trainingScreen').classList.remove('hidden');
            
            updateSegmentDisplay();
            
            if (currentMode === 'manual') {
                document.getElementById('manualInputs').classList.add('active');
            }
        }

        function updateSegmentDisplay() {
            const segment = currentWorkout.segments[currentSegmentIndex];
            if (!segment) return;

            document.getElementById('currentSegment').textContent = segment.name;
            document.getElementById('segmentDescription').textContent = segment.description;
            
            const targetPower = Math.round(currentUser.ftp * (segment.targetPercent / 100));
            document.getElementById('targetPowerDisplay').textContent = targetPower;
        }

        function toggleTraining() {
            if (!isTraining) {
                startTraining();
            } else {
                pauseTraining();
            }
        }

        function startTraining() {
            isTraining = true;
            isPaused = false;
            startTime = Date.now();
            
            document.getElementById('startBtn').classList.add('hidden');
            document.getElementById('pauseBtn').classList.remove('hidden');
            
            timerInterval = setInterval(updateTimer, 1000);
            
            if (currentMode === 'simulator') {
                startSimulation();
            }
        }

        function pauseTraining() {
            isPaused = !isPaused;
            const pauseBtn = document.getElementById('pauseBtn');
            
            if (isPaused) {
                pauseBtn.textContent = 'ì¬ì‹œì‘';
                clearInterval(timerInterval);
            } else {
                pauseBtn.textContent = 'ì¼ì‹œì •ì§€';
                timerInterval = setInterval(updateTimer, 1000);
            }
        }

        function stopTraining() {
            if (confirm('ì •ë§ í›ˆë ¨ì„ ì¢…ë£Œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                isTraining = false;
                clearInterval(timerInterval);
                showResults();
            }
        }

        function updateTimer() {
            if (isPaused) return;
            
            const elapsed = Date.now() - startTime;
            const minutes = Math.floor(elapsed / 60000);
            const seconds = Math.floor((elapsed % 60000) / 1000);
            
            document.getElementById('timerDisplay').textContent = 
                `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            
            // êµ¬ê°„ ì§„í–‰ë¥  ì—…ë°ì´íŠ¸
            const segment = currentWorkout.segments[currentSegmentIndex];
            if (segment) {
                const segmentProgress = Math.min(100, (elapsed / 1000) / segment.duration * 100);
                document.getElementById('segmentProgress').style.width = segmentProgress + '%';
                
                // ë‹¤ìŒ êµ¬ê°„ìœ¼ë¡œ ì „í™˜
                if (elapsed / 1000 >= segment.duration && currentSegmentIndex < currentWorkout.segments.length - 1) {
                    currentSegmentIndex++;
                    updateSegmentDisplay();
                }
            }
        }

        function updateManualData() {
            const power = parseInt(document.getElementById('manualPower').value) || 0;
            const cadence = parseInt(document.getElementById('manualCadence').value) || 0;
            const heartRate = parseInt(document.getElementById('manualHeartRate').value) || 0;
            
            document.getElementById('powerDisplay').textContent = power;
            document.getElementById('cadenceDisplay').textContent = cadence;
            document.getElementById('heartRateDisplay').textContent = heartRate;
            
            // ë°ì´í„° ê¸°ë¡
            if (isTraining && !isPaused) {
                workoutData.push({
                    timestamp: Date.now(),
                    power: power,
                    cadence: cadence,
                    heartRate: heartRate
                });
            }
        }

        function startSimulation() {
            const simulationInterval = setInterval(() => {
                if (!isTraining || isPaused) {
                    clearInterval(simulationInterval);
                    return;
                }
                
                const segment = currentWorkout.segments[currentSegmentIndex];
                if (!segment) return;
                
                const targetPower = Math.round(currentUser.ftp * (segment.targetPercent / 100));
                const variation = (Math.random() - 0.5) * 20;
                
                const power = Math.max(0, targetPower + variation);
                const cadence = 85 + (Math.random() - 0.5) * 10;
                const heartRate = 140 + (Math.random() - 0.5) * 20;
                
                document.getElementById('powerDisplay').textContent = Math.round(power);
                document.getElementById('cadenceDisplay').textContent = Math.round(cadence);
                document.getElementById('heartRateDisplay').textContent = Math.round(heartRate);
                
                workoutData.push({
                    timestamp: Date.now(),
                    power: power,
                    cadence: cadence,
                    heartRate: heartRate
                });
            }, 1000);
        }

        function showResults() {
            document.getElementById('trainingScreen').classList.add('hidden');
            document.getElementById('resultScreen').classList.remove('hidden');
            
            if (workoutData.length > 0) {
                const avgPower = workoutData.reduce((sum, d) => sum + d.power, 0) / workoutData.length;
                const maxPower = Math.max(...workoutData.map(d => d.power));
                const avgHR = workoutData.reduce((sum, d) => sum + d.heartRate, 0) / workoutData.length;
                const calories = Math.round(avgPower * (workoutData.length / 3600) * 3.6);
                
                document.getElementById('avgPowerResult').textContent = Math.round(avgPower);
                document.getElementById('maxPowerResult').textContent = Math.round(maxPower);
                document.getElementById('avgHRResult').textContent = Math.round(avgHR);
                document.getElementById('caloriesResult').textContent = calories;
            }
        }

        function saveWorkout() {
            alert('ìš´ë™ ê²°ê³¼ê°€ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!');
        }

        function shareWorkout() {
            const avgPower = document.getElementById('avgPowerResult').textContent;
            const avgHR = document.getElementById('avgHRResult').textContent;
            const calories = document.getElementById('caloriesResult').textContent;
            
            const shareText = `ğŸš´â€â™‚ï¸ ì‚¬ì´í´ ì•„ì¹´ë°ë¯¸ í›ˆë ¨ ì™„ë£Œ!

${currentWorkout.name}
í‰ê·  íŒŒì›Œ: ${avgPower}W
í‰ê·  ì‹¬ë°•: ${avgHR}bpm
ì¹¼ë¡œë¦¬: ${calories}kcal

ğŸ“± iOSì—ì„œë„ ì™„ë²½í•œ í›ˆë ¨!`;

            if (navigator.share) {
                navigator.share({
                    title: 'ì‚¬ì´í´ ì•„ì¹´ë°ë¯¸ - í›ˆë ¨ ì™„ë£Œ!',
                    text: shareText
                });
            } else {
                navigator.clipboard.writeText(shareText).then(() => {
                    alert('ê²°ê³¼ê°€ í´ë¦½ë³´ë“œì— ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!');
                });
            }
        }

        function restartApp() {
            location.reload();
        }

        // PWA ê°ì§€ ë° ì„¤ì¹˜ í”„ë¡¬í”„íŠ¸
        let deferredPrompt;
        window.addEventListener('beforeinstallprompt', (e) => {
            deferredPrompt = e;
            // iOSì—ì„œëŠ” ì´ ì´ë²¤íŠ¸ê°€ ë°œìƒí•˜ì§€ ì•Šì§€ë§Œ, ë‹¤ë¥¸ í”Œë«í¼ì—ì„œëŠ” ì„¤ì¹˜ ë²„íŠ¼ í‘œì‹œ ê°€ëŠ¥
        });

        // iOSì—ì„œ í™ˆ í™”ë©´ ì¶”ê°€ ê°ì§€
        if (window.navigator.standalone) {
            // ì´ë¯¸ í™ˆ í™”ë©´ì— ì¶”ê°€ëœ ìƒíƒœ
            document.querySelector('.pwa-install').style.display = 'none';
        }
    </script>
</body>
</html>
