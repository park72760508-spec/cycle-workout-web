<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Cycle Workout WebApp v4.0</title>
  <link rel="stylesheet" href="./assets/css/style.css" />
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
  <header class="app-header">
    <h1>ğŸš´â€â™€ï¸ Cycle Workout WebApp</h1>
    <nav>
      <button id="btnInitDB" class="ghost">DB ë³´ì •</button>
      <button id="btnAddSample" class="ghost">ìƒ˜í”Œ ì£¼ì…</button>
    </nav>
  </header>
  <main id="app">
    <section class="panel">
      <h2>ê¸°ê¸° ì—°ê²°</h2>
      <div class="device-grid">
        <div class="card"><h3>ìŠ¤ë§ˆíŠ¸ë¡œë¼ (FTMS)</h3><button id="btnConnectTrainer">ì—°ê²°</button><div class="status" id="trainerStatus">ë¯¸ì—°ê²°</div></div>
        <div class="card"><h3>íŒŒì›Œë¯¸í„° (CPS)</h3><button id="btnConnectPM">ì—°ê²°</button><div class="status" id="pmStatus">ë¯¸ì—°ê²°</div></div>
        <div class="card"><h3>ì‹¬ë°•ê³„ (HRS)</h3><button id="btnConnectHR">ì—°ê²°</button><div class="status" id="hrStatus">ë¯¸ì—°ê²°</div></div>
      </div>
      <h2>ì‚¬ìš©ì</h2>
      <div class="form-row"><label>ì´ë¦„</label><input id="userName" placeholder="í™ê¸¸ë™" /></div>
      <div class="form-row"><label>ì—°ë½ì²˜</label><input id="userContact" placeholder="010-0000-0000" /></div>
      <div class="form-row"><label>FTP(W)</label><input id="userFTP" type="number" placeholder="230" /></div>
      <div class="form-row"><label>ëª¸ë¬´ê²Œ(kg)</label><input id="userWeight" type="number" placeholder="68" /></div>
      <button id="btnAddUser" class="primary">ì‚¬ìš©ì ì €ì¥</button>
      <h2>ì„¸ì…˜</h2>
      <div class="session-row">
        <button id="btnStart" class="primary">ì„¸ì…˜ ì‹œì‘</button>
        <button id="btnToggleLive">ì‹¤ì‹œê°„ ì „ì†¡ ON/OFF</button>
        <button id="btnComplete" class="danger">ì„¸ì…˜ ì™„ë£Œ</button>
      </div>
      <div class="info-row"><div>ì„¸ì…˜ID: <span id="sessionId">-</span></div><div>ìƒíƒœ: <span id="sessionState">ëŒ€ê¸°</span></div></div>
    </section>
    <section class="workout">
      <div class="metrics"><div class="metric"><div class="metric-value" id="powerValue">0</div><div class="metric-label">Power (W)</div></div></div>
      <div id="countdown" class="countdown hidden">5</div>
      <div class="timeline" id="timeline"></div>
      <canvas id="liveChart"></canvas>
      <section class="ai"><h3>ğŸ¤– AI ë¶„ì„</h3><pre id="aiAnalysis">(ì„¸ì…˜ ì™„ë£Œ í›„ í‘œì‹œë©ë‹ˆë‹¤)</pre></section>
    </section>
  </main>
  <script type="module">
    import { setupApp } from './assets/js/app.js';
    import { setupBLE } from './assets/js/ble.js';
    import { setupTraining } from './assets/js/training.js';
    import { setupUI } from './assets/js/ui.js';
    import { setupChart } from './assets/js/chart.js';
    const ctx={gasUrl:'https://script.google.com/macros/s/AKfycbwp6v4zwoRi0qQekKQZr4bCs8s2wUolHtLNKgq_uX8pIHck1XllibKgzCZ64w6Z7Wrw/exec',sessionId:null,user:{name:'',contact:'',ftp:230,weight:68},live:{power:0,cadence:0,hr:0},timers:{liveInterval:null},chart:null};
    setupUI(ctx);setupChart(ctx);setupApp(ctx);setupBLE(ctx);setupTraining(ctx);
  </script>
</body>
</html>
