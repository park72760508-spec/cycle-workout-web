/* ==========================================================
   Cycle Workout App UI Style — 통합본 (by ChatGPT)
   정렬 기준: index.html 화면 구성 순서
   정책: 중복선언은 '후순위 선언 유지 / 선순위 제거', 시맨틱 우선
   주요 수정: 중복/충돌 제거, 오타 수정(font-size), 그룹 좌측 라인 복원,
            마스코트 레이어 규칙 추가, 반응형 블록 병합
   섹션 목차
     0) Base / Reset / Utilities
     1) 공통 컴포넌트 (카드/버튼/폼/그리드)
     2) #connectionScreen  (연결 화면)
     3) #profileScreen     (프로필 선택)
     4) #workoutScreen     (워크아웃 선택)
     5) #trainingReadyScreen(훈련 준비)
     6) #trainingScreen    (훈련)
        6-1) 메트릭/파워/컨트롤
        6-2) 타임라인(세그먼트 바 + 그룹 + 마스코트)
     7) #resultScreen      (결과)
     8) 워크아웃/세그먼트 관리 UI
     9) 모달 / 상태 / 공통 애니메이션
    10) 반응형 공통
========================================================== */

/* ========== 0) Base / Reset / Utilities ========== */
* { box-sizing: border-box; margin: 0; padding: 0; }
html, body { height: 100%; }
body {
  font-family: "Pretendard", "Noto Sans KR", system-ui, -apple-system, Segoe UI, Roboto, sans-serif;
  background: #f6f8fa;
  color: #222;
  overflow-x: hidden;
}

h1,h2,h3,h4 { font-weight: 600; }
.text-center{ text-align:center; }
.center{ text-align:center; }
.muted{ color:#777; font-size:.9em; }
.mb-10{ margin-bottom:10px; }
.mb-15{ margin-bottom:15px; }
.mb-20{ margin-bottom:20px; }
.mb-30{ margin-bottom:30px; }
.mt-5{ margin-top:5px; }
.mt-10{ margin-top:10px; }
.mt-20{ margin-top:20px; }
.hidden{ display:none !important; }

.screen { display:none; min-height:100vh; padding:20px; transition:opacity .3s ease; }
.screen.active { display:block; }
.header { text-align:center; margin-bottom:20px; }
.header h1 { font-size:1.8em; margin-bottom:5px; }
.subtitle { font-size:.9em; color:#666; }

/* ========== 1) 공통 컴포넌트 ========== */
.card {
  background:#fff; border-radius:12px; padding:18px;
  box-shadow:0 2px 8px rgba(0,0,0,.05); margin-bottom:16px;
}
.grid-2{ display:grid; grid-template-columns:repeat(2,1fr); }
.gap-10{ gap:10px; }

/* 버튼 */
.btn{
  background:#2e74e8; color:#fff; border:none; border-radius:8px;
  padding:10px 14px; cursor:pointer; transition:background .2s;
}
.btn:hover{ background:#2562c8; }
.btn-secondary{ background:#6c757d; }
.btn-success{ background:#28a745; }
.btn-row{ display:flex; justify-content:center; gap:10px; }
.btn:disabled{ opacity:.7; cursor:not-allowed; }

/* 폼 */
.form-group{ margin-bottom:12px; }
.form-group label{ display:block; font-size:.9em; margin-bottom:4px; color:#555; }
.form-group input{ width:100%; padding:8px; border:1px solid #ccc; border-radius:6px; }
.form-group select{ width:100%; padding:8px 12px; border:1px solid #d1d5db; border-radius:8px; background:#fff; font-size:14px; }
.form-group select:focus{ outline:none; border-color:#2e74e8; box-shadow:0 0 0 3px rgba(46,116,232,.1); }
.form-row{ display:grid; grid-template-columns:1fr 1fr; gap:16px; }

/* 아이콘형 컨트롤 버튼 (공통) */
.control-btn{
  border:none; background:#fff; font-size:22px; border-radius:50%;
  width:55px; height:55px; margin:0 8px; cursor:pointer;
  box-shadow:0 2px 6px rgba(0,0,0,.15);
}
.control-btn.stop{ color:#d33; }
.control-btn.pause{ color:#f0a500; }

/* ========== 2) 연결 화면 (#connectionScreen) ========== */
#connectionScreen .ios-info{
  background:#fff; border:1px solid #e5e7eb; border-radius:12px;
  padding:14px 16px; margin:10px 0 16px; box-shadow:0 4px 16px rgba(0,0,0,.06);
  color:#4b5563;
}
#connectionScreen .ios-indicator{
  display:inline-flex; align-items:center; gap:8px; padding:6px 10px; border-radius:999px;
  background:#f3f4f6; color:#374151; font-weight:700; font-size:12px; margin-bottom:8px; border:1px solid #e5e7eb;
}
#connectionScreen .ios-text{ margin:6px 0 10px; color:#6b7280; font-size:10px; }
#connectionScreen .btn-ios-continue{
  display:inline-flex; align-items:center; justify-content:center; padding:8px 14px; font-weight:700; border-radius:10px; border:1px solid transparent;
  background:#22c55e; color:#fff; cursor:pointer; transition:transform .05s ease, filter .15s ease, box-shadow .15s ease; box-shadow:0 2px 8px rgba(34,197,94,.25);
}
#connectionScreen .btn-ios-continue:hover{ filter:brightness(1.03); }
#connectionScreen .btn-ios-continue:active{ transform:translateY(1px); }

.ios-disabled{ pointer-events:none !important; opacity:.45; filter:grayscale(45%); }
.ios-disabled .btn, .ios-disabled button, button[aria-disabled="true"]{ pointer-events:none !important; cursor:not-allowed !important; opacity:.55; }

.device-card{ display:flex; justify-content:space-between; align-items:center; padding:15px; margin-bottom:10px; background:#f8f9fa; border-radius:10px; transition:.3s; }
.device-card.connected{ background:#e8f5e9; border:1px solid #4caf50; }
.device-info{ display:flex; align-items:center; gap:15px; }
.device-icon{ width:50px; height:50px; background:#2e74e8; border-radius:50%; display:flex; align-items:center; justify-content:center; font-size:24px; }
.device-icon[style*="background:#DC3545"]{ background:#DC3545 !important; }
.device-details h3{ margin:0; font-size:16px; font-weight:600; }
.device-details p{ margin:2px 0 0 0; font-size:14px; color:#666; }
#connectedDevicesList{ margin:20px 0; }
#connectedDevicesSummary{ margin-top:20px; }
#connectedDevicesSummary h3{ display:flex; align-items:center; gap:10px; }

/* ========== 3) 프로필 선택 (#profileScreen) ========== */
#profileScreen{ --card-bg:#fff; --card-border:#e5e7eb; --text-strong:#111827; --text:#374151; --text-muted:#6b7280; --brand:#2e74e8; --accent-ok:#22c55e; }
#profileScreen #userList{ display:grid; grid-template-columns:repeat(auto-fit, minmax(220px,1fr)); gap:12px; margin-bottom:16px; }
#profileScreen .user-card{ background:var(--card-bg); border:1px solid var(--card-border); border-radius:14px; padding:14px; color:var(--text); box-shadow:0 6px 18px rgba(0,0,0,.06); transition:transform .12s ease, box-shadow .12s ease, border-color .12s ease; }
#profileScreen .user-card:hover{ transform:translateY(-2px); box-shadow:0 10px 24px rgba(0,0,0,.08); border-color:#d1d5db; }
#profileScreen .user-card .user-name{ font-weight:700; font-size:16px; color:var(--text-strong); margin-bottom:4px; }
#profileScreen .user-card .user-meta{ color:var(--text-muted); font-size:13px; }
#profileScreen .btn{ display:inline-flex; align-items:center; justify-content:center; padding:8px 12px; font-weight:700; border-radius:10px; border:1px solid transparent; cursor:pointer; }
#profileScreen .btn.btn-primary{ background:var(--accent-ok); color:#fff; box-shadow:0 2px 8px rgba(34,197,94,.2); }
#profileScreen .btn.btn-primary:hover{ filter:brightness(1.03); }
#profileScreen .btn.btn-primary:active{ transform:translateY(1px); }
#profileScreen .user-card:focus-within, #profileScreen .user-card:has(.btn:focus){ border-color:var(--brand); box-shadow:0 0 0 3px rgba(46,116,232,.18); }
#profileScreen #cardAddUser{ background:#fff; border:1px dashed var(--card-border); border-radius:14px; text-align:center; padding:18px; color:var(--text); }

/* ========== 4) 워크아웃 선택 (#workoutScreen) ========== */
.workout-list{ display:grid; gap:12px; }
.builder-actions{ position:sticky; bottom:0; background:#fff; padding:12px 0 16px; z-index:50; box-shadow:0 -4px 12px rgba(0,0,0,.06); }
.builder-actions .btn-row{ justify-content:center; gap:12px; }
.builder-actions, .builder-actions *{ pointer-events:auto; }

/* ========== 5) 훈련 준비 (#trainingReadyScreen) ========== */
.workout-preview{ background:#fff; border-radius:12px; padding:20px; margin-bottom:20px; box-shadow:0 2px 8px rgba(0,0,0,.05); position:relative; z-index:1; -webkit-overflow-scrolling:touch; }
.workout-preview h2{ text-align:center; color:#2e74e8; margin-bottom:20px; font-size:24px; }
.preview-stats{ display:grid; grid-template-columns:repeat(3,1fr); gap:15px; margin-bottom:20px; text-align:center; }
.preview-stats > div{ padding:15px; background:#f8f9fa; border-radius:8px; }
.preview-stats strong{ font-size:28px; color:#2e74e8; display:block; margin-bottom:5px; }
.segment-preview{ display:flex; gap:6px; margin:20px 0; padding:9px; background:#f8f9fa; border-radius:8px; overflow-x:auto; align-items:center; position:relative; z-index:1; }
.segment-item{ padding:15px 20px; border-radius:8px; min-width:120px; text-align:center; color:#fff; display:flex; flex-direction:column; align-items:center; justify-content:center; }
.segment-item h4{ font-size:14px; margin:0 0 10px; font-weight:500; }
.segment-item .ftp-percent{ font-size:26px; font-weight:700; margin:5px 0; line-height:1; }
.segment-item .duration{ font-size:13px; opacity:.9; margin-top:5px; }
.segment-item.warmup{ background:#4caf50; } .segment-item.interval{ background:#2196f3; } .segment-item.rest{ background:#9e9e9e; }
.training-ready{ background:#fff; border-radius:12px; padding:20px; box-shadow:0 2px 8px rgba(0,0,0,.05); text-align:center; position:relative; z-index:1; padding-bottom:100px; }
.btn-row.center{ display:flex !important; justify-content:center !important; align-items:center !important; margin:20px auto !important; width:100% !important; text-align:center !important; position:relative; z-index:100; background:#fff; padding:15px 0; border-radius:8px; box-shadow:0 -2px 8px rgba(0,0,0,.1); }

/* ========== 6) 훈련 (#trainingScreen) ========== */
#trainingScreen{ background:#0f111a; color:#f3f3f3; padding:16px 20px; min-height:100vh; display:flex; flex-direction:column; gap:16px; }

/* 6-1) 메트릭/파워/컨트롤 */
#trainingScreen .training-header{ display:grid; gap:8px; align-items:center; background:#181a22; padding:8px 12px; border-radius:10px; margin:10px 0 16px; box-shadow:0 2px 6px rgba(0,0,0,.35); }
#trainingScreen #userInfo::before{ content:"👤"; margin-right:8px; }
#trainingScreen .segment-details1{ display:grid; grid-template-columns:1fr 1fr 1fr; gap:8px; align-items:center; background:#181a22; color:#f3f3f3; padding:8px 12px; border-radius:10px; margin:10px 0 16px; box-shadow:0 2px 6px rgba(0,0,0,.35); }
#trainingScreen .seg-left1{text-align:left;} .seg-center1{text-align:center;} .seg-right1{text-align:right;}
#trainingScreen .elapsed-wrap1::before{ content:"⏱"; margin-right:6px; }
#trainingScreen #nextSegment::before{ content:"⭐"; margin-right:6px; }
#trainingScreen .metrics-grid{ display:grid; grid-template-columns:1fr 1.2fr 1fr; gap:15px; margin-bottom:20px; }
#trainingScreen .metric-card{ background:#1b1e2b; padding:15px; border-radius:15px; box-shadow:inset 0 0 12px rgba(255,255,255,.05); text-align:center; }
#trainingScreen .metric-card .metric-value{ font-size:40px; font-weight:700; }
#trainingScreen .metric-card .metric-label{ font-size:13px; color:#aaa; }
#trainingScreen .power-display{ background:linear-gradient(180deg,#22283b,#1a1d2a); border-radius:20px; text-align:center; padding:20px; box-shadow:0 3px 10px rgba(0,0,0,.5); }
#trainingScreen .current-power{ font-size:80px; font-weight:800; color:#00d9ff; }
#trainingScreen .unit-dim{ font-size:14px; color:#aaa; }
#trainingScreen .power-progress{ height:30px; background:#202331; border-radius:10px; margin:16px 0 10px; overflow:hidden; position:relative; }
#trainingScreen .power-progress-bar{ height:100%; width:0%; border-radius:10px; transition:width .35s ease, background .25s ease; }
#trainingScreen .power-progress-label{ margin-top:8px; font-size:13px; color:#cfd3da; display:flex; justify-content:space-between; } /* ← 0.13px 오타 수정 */
#trainingScreen .dual-metric .metric-item{ margin-bottom:10px; }
#trainingScreen .dual-metric .metric-value{ font-size:40px; font-weight:bold; color:#ff3c6a; }
#trainingScreen .dual-metric .metric-label{ font-size:13px; color:#ccc; }

/* 컨트롤 */
#trainingScreen .training-controls{ display:flex; justify-content:center; gap:25px; margin-top:20px; }
#trainingScreen .control-btn{ width:60px; height:60px; border-radius:50%; border:none; background:#2b2e3e; color:#fff; font-size:22px; cursor:pointer; transition:transform .2s, background .2s; }
#trainingScreen .control-btn:hover{ background:#39405b; transform:scale(1.1); }
#trainingScreen .control-btn.stop{ background:#ff4c4c; }
#trainingScreen .control-btn.pause{ background:#ffaa00; }

/* 6-2) 타임라인(세그먼트 바 + 그룹 + 마스코트) */
.timeline-wrap{ background:linear-gradient(135deg,#1e293b 0%, #0f172a 100%); border-radius:16px; padding:16px 20px; margin-top:20px; box-shadow:0 8px 32px rgba(0,0,0,.2); }
.timeline-legend{ margin-top:12px; padding-top:12px; border-top:1px solid rgba(148,163,184,.2); text-align:center; font-size:12px; color:#94a3b8; }

.timeline-progress.timeline--xl{ height:50px; border-radius:16px; background:rgba(34,197,94,.05); box-shadow:inset 0 2px 8px rgba(0,0,0,.06), 0 4px 12px rgba(34,197,94,.08); border:1px solid rgba(34,197,94,.15); overflow:hidden; position:relative; }
.timeline-segments{ display:flex; height:100%; position:relative; }
.timeline-segment{ position:relative; display:flex; flex-direction:column; align-items:center; justify-content:center; padding:0; background:transparent; font-size:11px; font-weight:500; color:#cbd5e1; transition:all .3s ease; overflow:hidden; min-width:0; }
/* 인접한 세그먼트 사이 1px 라인 */
.timeline-segment + .timeline-segment{ border-left:1px solid rgba(148,163,184,.18); }
.timeline-segment:last-child{ border-right:none; }
.segment-labels{ display:flex; flex-direction:column; align-items:center; justify-content:center; z-index:3; position:relative; gap:1px; }
.segment-number{ font-size:10px; font-weight:600; color:#475569; line-height:1; opacity:.8; }
.segment-time{ font-size:9px; font-weight:400; color:#64748b; line-height:1; margin-top:1px; }
.repeat-count{ font-size:8px; font-weight:600; color:#0ea5e9; background:rgba(14,165,233,.1); padding:1px 4px; border-radius:6px; line-height:1; margin:1px 0; }
.progress-fill{ opacity:.32; position:absolute; inset:0 auto 0 0; height:100%; width:0%; z-index:1; transition:width .4s ease-out, background .3s ease; border-radius:inherit; }
.timeline-segment:first-child .progress-fill{ border-radius:16px 0 0 16px; }
.timeline-segment:last-child  .progress-fill{ border-radius:0 16px 16px 0; }

/* 타입별 진행 색상 */
.timeline-segment[data-type="warmup"]   .progress-fill{ background:linear-gradient(135deg,#22c55e 0%, #16a34a 100%); }
.timeline-segment[data-type="interval"] .progress-fill{ background:linear-gradient(135deg,#ef4444 0%, #dc2626 100%); }
.timeline-segment[data-type="rest"]     .progress-fill{ background:linear-gradient(135deg,#06b6d4 0%, #0891b2 100%); }
.timeline-segment[data-type="cooldown"] .progress-fill{ background:linear-gradient(135deg,#8b5cf6 0%, #7c3aed 100%); }
.timeline-segment[data-type="tempo"]    .progress-fill{ background:linear-gradient(135deg,#f59e0b 0%, #d97706 100%); }
.timeline-segment[data-type="sweetspot"].progress-fill{ background:linear-gradient(135deg,#3b82f6 0%, #2563eb 100%); }

/* 상태 */
.timeline-segment.is-upcoming{ background:transparent !important; box-shadow:none !important; }
.timeline-segment.is-current{ border-top:1px solid rgba(34,197,94,.25) !important; border-bottom:1px solid rgba(34,197,94,.25) !important; }
.timeline-segment.is-current .segment-number, .timeline-segment.is-current .segment-time{ color:#15803d; font-weight:600; }
.timeline-segment.is-current::after{ content:""; position:absolute; bottom:-3px; left:50%; transform:translateX(-50%); width:60%; height:3px; background:linear-gradient(90deg,transparent,#22c55e,transparent); border-radius:2px; }
.timeline-segment.is-complete{ color:#fff; text-shadow:0 1px 2px rgba(0,0,0,.3); }
.timeline-segment.is-complete .segment-number, .timeline-segment.is-complete .segment-time, .timeline-segment.is-complete .repeat-count{ color:#fff; }
/* 달성도별 완료 색상 */
.timeline-segment.is-complete.achievement-low  .progress-fill{ background:rgba(245,158,11,.28); opacity:.55; }
.timeline-segment.is-complete.achievement-good .progress-fill{ background:rgba(34,197,94,.28);  opacity:.55; }
.timeline-segment.is-complete.achievement-high .progress-fill{ background:rgba(64,224,208,.30); opacity:.55; }
.timeline-segment.is-complete.achievement-over .progress-fill{ background:rgba(64,224,208,.30); opacity:.55; }
/* 완료 + 휴식(rest)은 녹색 우선 */
.timeline-segment.is-complete[data-type="rest"] .progress-fill{ background:rgba(34,197,94,.30) !important; opacity:.60 !important; }

/* 그룹 세그먼트(랩퍼) — 좌측 세로 라인 복원 */
.timeline-group{ position:relative; border:none !important; background:transparent !important; }
.timeline-group::before{ content:""; position:absolute; left:0; top:0; bottom:0; width:1px; background:rgba(148,163,184,.18); pointer-events:none; }
.timeline-group.is-upcoming{ background:rgba(34,197,94,.08) !important; box-shadow:inset 0 0 0 1px rgba(34,197,94,.25) !important; }
.timeline-group.is-current { background:transparent !important; box-shadow:inset 0 0 0 1px rgba(34,197,94,.22) !important; }
.timeline-group.is-complete.achievement-low,
.timeline-group.is-complete.achievement-good,
.timeline-group.is-complete.achievement-high,
.timeline-group.is-complete.achievement-over{ background:transparent !important; border-color:transparent !important; }

/* 마스코트/골 깃발 레이어 */
#timelineMascotLayer{ position:absolute; inset:0; pointer-events:none; }
#timelineMascotLayer #progressMascot{ position:absolute; bottom:4px; left:0; height:40px; transform:translateX(var(--mascot-x,0px)); transition:transform .2s linear; will-change:transform; }
#timelineMascotLayer #goalFlag{ position:absolute; right:6px; bottom:4px; height:38px; filter:drop-shadow(0 1px 2px rgba(0,0,0,.45)); }

/* 현재 세그먼트명 진행 시각화 (이름 배경 진행) */
.enhanced-current-segment-name{ position:relative; overflow:hidden; border-radius:10px; padding:6px 10px; font-size:16px; font-weight:600; color:#e5e7eb; background:rgba(255,255,255,.05); border:1px solid rgba(255,255,255,.1); }
.enhanced-current-segment-name::before{ content:""; position:absolute; inset:0; width:var(--name-progress,0%); background:linear-gradient(90deg, rgba(245,158,11,.22) 0%, rgba(245,158,11,.14) 100%); border-right:1px solid rgba(245,158,11,.35); pointer-events:none; z-index:0; transition:width 160ms linear; }
.enhanced-current-segment-name, .enhanced-current-segment-name *{ position:relative; z-index:1; }

/* ========== 7) 결과 (#resultScreen) ========== */
.achievement-circle{ width:150px; height:150px; border-radius:50%; background:linear-gradient(135deg,#2e74e8,#00c6ff); margin:0 auto 20px; display:flex; align-items:center; justify-content:center; color:#fff; box-shadow:0 3px 8px rgba(0,0,0,.2); }
.achievement-text{ font-size:2.2em; font-weight:700; }
.result-stats{ display:flex; justify-content:space-around; flex-wrap:wrap; margin:15px 0; }
.result-stat{ text-align:center; width:45%; margin-bottom:15px; }
.result-stat-value{ font-size:28px; font-weight:600; color:#2e74e8; }
.result-stat-label{ font-size:.9em; color:#777; }

/* ========== 8) 워크아웃/세그먼트 관리 ========== */
.workout-card{ position:relative; border:1px solid #e5e7eb; border-radius:12px; padding:16px; margin-bottom:12px; background:#fff; transition:all .2s ease; }
.workout-card:hover{ border-color:#2e74e8; box-shadow:0 4px 12px rgba(46,116,232,.1); }
.workout-header{ display:flex; justify-content:space-between; align-items:center; margin-bottom:8px; }
.workout-title{ font-weight:600; font-size:16px; color:#111827; }
.workout-actions{ display:flex; gap:8px; }
.workout-details{ margin-bottom:12px; }
.workout-meta{ display:flex; gap:12px; align-items:center; margin-bottom:8px; }
.workout-meta .author,.workout-meta .duration{ font-size:14px; color:#374151; }
.workout-meta .duration{ background:#f3f4f6; padding:2px 8px; border-radius:12px; }
.workout-description{ font-size:14px; color:#6b7280; margin-bottom:8px; }
.publish-date{ font-size:12px; color:#9ca3af; }
.status-badge{ font-size:12px; padding:2px 8px; border-radius:12px; font-weight:500; }
.status-badge.visible{ background:#dcfce7; color:#166534; }
.status-badge.hidden{ background:#fee2e2; color:#991b1b; }
.form-help{ font-size:12px; color:#6b7280; margin-top:4px; display:block; }

/* 세그먼트 리스트/카드 */
.segment-header{ display:flex; justify-content:space-between; align-items:center; margin-bottom:16px; }
.segment-summary{ display:flex; gap:16px; font-size:14px; color:#6b7280; }
.segment-summary strong{ color:#2e74e8; }
.segments-list{ min-height:120px; border:2px dashed #e5e7eb; border-radius:8px; padding:16px; margin-bottom:16px; }
.segments-empty{ text-align:center; color:#9ca3af; padding:20px; }
.segment-card{ background:#f8f9fa; border:1px solid #e5e7eb; border-radius:8px; padding:16px; margin-bottom:8px; display:flex; align-items:center; gap:12px; cursor:pointer; transition:all .2s; }
.segment-card:hover{ border-color:#2e74e8; transform:translateY(-1px); box-shadow:0 2px 8px rgba(46,116,232,.1); }
.segment-card.dragging{ opacity:.5; transform:rotate(2deg); }
.segment-info{ flex:1; display:flex; align-items:center; gap:12px; }
.segment-type-badge{ padding:4px 8px; border-radius:12px; font-size:12px; font-weight:500; text-transform:uppercase; }
.segment-type-badge.warmup{ background:#fef3c7; color:#92400e; }
.segment-type-badge.interval{ background:#fecaca; color:#991b1b; }
.segment-type-badge.rest{ background:#dbeafe; color:#1d4ed8; }
.segment-type-badge.sweetspot{ background:#f3e8ff; color:#7c3aed; }
.segment-type-badge.tempo{ background:#d1fae5; color:#065f46; }
.segment-type-badge.threshold{ background:#fed7aa; color:#c2410c; }
.segment-type-badge.vo2max{ background:#fce7f3; color:#be185d; }
.segment-type-badge.cooldown{ background:#e0f2fe; color:#0c4a6e; }
.segment-details{ display:flex; flex-direction:column; gap:2px; }
.segment-label{ font-weight:600; color:#111827; }
.segment-meta{ font-size:14px; color:#6b7280; }
.segment-intensity{ font-weight:600; color:#2e74e8; }
.segment-actions{ display:flex; align-items:center; gap:8px; }
.segment-drag-handle{ cursor:grab; color:#9ca3af; padding:4px; }
.segment-drag-handle:active{ cursor:grabbing; }
.segment-edit-btn,.segment-delete-btn{ background:none; border:none; padding:4px; border-radius:4px; cursor:pointer; font-size:14px; transition:background .2s; }
.segment-edit-btn:hover{ background:#e0f2fe; } .segment-delete-btn:hover{ background:#fee2e2; }
.quick-add-buttons{ display:flex; gap:8px; flex-wrap:wrap; }
.btn-sm{ padding:6px 12px; font-size:12px; }
.btn-icon{ margin-right:4px; }

/* ========== 9) 모달 / 상태 / 애니메이션 ========== */
.modal{ position:fixed; inset:0; background:rgba(0,0,0,.5); display:flex; align-items:center; justify-content:center; z-index:99999; -webkit-tap-highlight-color:transparent !important; touch-action:none !important; }
.modal.hidden{ display:none; }
.modal-content{ background:#fff; border-radius:12px; width:90%; max-width:500px; max-height:90vh; overflow-y:auto; box-shadow:0 20px 25px -5px rgba(0,0,0,.1); z-index:100000; touch-action:auto !important; }
.modal-header{ display:flex; justify-content:space-between; align-items:center; padding:20px 24px; border-bottom:1px solid #e5e7eb; }
.modal-header h3{ margin:0; font-size:18px; font-weight:600; }
.modal-close{ background:none; border:none; font-size:18px; cursor:pointer; color:#9ca3af; padding:4px; }
.modal-close:hover{ color:#374151; }
.modal-body{ padding:24px; }
.modal-footer{ padding:25px; border-top:1px solid #e5e7eb; display:flex; gap:15px; justify-content:flex-end; }
.modal-footer .btn{ min-height:50px; min-width:100px; padding:15px 25px; font-size:16px; position:relative; z-index:100001; cursor:pointer; -webkit-touch-callout:none; -webkit-user-select:none; touch-action:manipulation; }

.loading-container{ animation:fadeIn .3s ease-in; }
@keyframes fadeIn{ from{opacity:0;} to{opacity:1;} }
.empty-state{ animation:slideUp .5s ease-out; }
@keyframes slideUp{ from{ opacity:0; transform:translateY(20px);} to{ opacity:1; transform:translateY(0);} }
.user-card,.workout-card{ transition:all .2s ease; }
.user-card:hover,.workout-card:hover{ transform:translateY(-2px); box-shadow:0 8px 25px rgba(46,116,232,.15); }
.loading-text{ animation:pulse 1.5s ease-in-out infinite; }
.success-state{ text-align:center; padding:40px 20px; background:#f0fdf4; border:1px solid #bbf7d0; border-radius:12px; margin:20px 0; }
.success-state-icon{ font-size:32px; color:#22c55e; margin-bottom:12px; }
.success-state-title{ font-size:16px; font-weight:600; color:#16a34a; margin-bottom:8px; }
.saving-state{ position:relative; overflow:hidden; }
.saving-state::after{ content:""; position:absolute; top:0; left:-100%; width:100%; height:100%; background:linear-gradient(90deg,transparent,rgba(255,255,255,.4),transparent); animation:saving-shimmer 1.5s infinite; }
@keyframes saving-shimmer{ 0%{left:-100%;} 100%{left:100%;} }
.btn-saving{ background:#6c757d !important; cursor:not-allowed !important; opacity:.8; }
.btn-saving .saving-spinner{ display:inline-block; width:16px; height:16px; border:2px solid #fff; border-radius:50%; border-top-color:transparent; animation:spin 1s linear infinite; margin-right:8px; }
@keyframes spin{ to{ transform:rotate(360deg); } }

/* ========== 10) 반응형 공통 ========== */
@media (max-width:768px){
  #profileScreen #userList{ grid-template-columns:1fr; }
  #trainingScreen .current-power{ font-size:48px; }
  #trainingScreen .segment-details1{ font-size:14px; }
  .timeline-progress.timeline--xl{ height:45px; }
  .segment-labels{ gap:0; }
  .segment-number{ font-size:9px; }
  .segment-time{ font-size:8px; }
  .repeat-count{ font-size:7px; padding:1px 3px; }
  .timeline-wrap{ padding:12px 16px; }
}

/* 태블릿 가로(≤1024) */
@media (max-width:1024px) and (min-width:769px){
  .enhanced-metrics-grid{ grid-template-columns:.7fr 1.8fr .7fr; gap:16px; }
  .enhanced-current-power-value{ font-size:80px; }
  .enhanced-target-value,.enhanced-avg-value{ font-size:48px; }
  .enhanced-countdown-value{ font-size:48px; }
}
/* 태블릿 세로(481~1024) */
@media (max-width:1024px) and (min-width:481px){
  .enhanced-metrics-grid{ grid-template-columns:.7fr 1.8fr .7fr; gap:12px; }
  .enhanced-metric-panel{ padding:16px 12px; }
  .enhanced-current-power-value{ font-size:64px; }
  .enhanced-target-value,.enhanced-avg-value{ font-size:46px; }
  .enhanced-countdown-value{ font-size:46px; }
  .enhanced-left-panel .enhanced-metric-value, .enhanced-right-panel .enhanced-metric-value{ font-size:28px; }
  .enhanced-training-time-info{ grid-template-columns:1fr 1fr; gap:12px; }
}
/* 모바일(≤480) 단일열 */
@media (max-width:480px){
  .enhanced-metrics-grid{ grid-template-columns:1fr; gap:16px; }
  .enhanced-training-time-info{ grid-template-columns:1fr; gap:12px; }
  .enhanced-current-power-value{ font-size:56px; }
  .enhanced-target-value,.enhanced-avg-value{ font-size:44px; }
  .enhanced-countdown-value{ font-size:44px; }
  .enhanced-left-panel .enhanced-metric-value, .enhanced-right-panel .enhanced-metric-value{ font-size:24px; }
}

/* 고해상도 최적화 */
@media (-webkit-min-device-pixel-ratio:2), (min-resolution:192dpi){
  .progress-fill{ background-size:100% 100%; }
  .timeline-segment.is-current::after{ background:linear-gradient(90deg,transparent,#3b82f6,rgba(59,130,246,.8),#3b82f6,transparent); }
}

/* iOS Safari 개선 */
@supports (-webkit-touch-callout:none){
  .modal-footer .btn{ -webkit-tap-highlight-color:rgba(0,0,0,.1); -webkit-transform:translateZ(0); transform:translateZ(0); -webkit-backface-visibility:hidden; backface-visibility:hidden; }
  .modal-footer .btn:active{ background-color:rgba(0,0,0,.1) !important; transform:scale(.98) !important; }
}

/* ================== [삭제/통합 메모] ==================
 - #trainingScreen, .enhanced-* 블록의 중복 선언: 후순위(스타일 강화) 규칙을 유지하고 앞선 중복 제거
 - .form-row, .modal, 반응형 @media 블록의 중복: 선언 하나로 병합
 - .power-progress-label의 font-size 오타(.13px) → 13px 수정
 - 그룹 좌측 세로 라인: .timeline-group::before 로 일원화 (border 강제 제거)
 - 마스코트 레이어: #timelineMascotLayer, #progressMascot, #goalFlag 신규 추가
======================================================= */
